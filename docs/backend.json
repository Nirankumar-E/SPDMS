
{
  "entities": {
    "Citizen": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Citizen",
      "type": "object",
      "description": "Represents a citizen's profile and ration card details in the Public Distribution System.",
      "properties": {
        "cardType": {
          "type": "string",
          "description": "Type of the family card (e.g., PHH, NPHH)."
        },
        "fpsCode": {
          "type": "string",
          "description": "The code for the Fair Price Shop assigned to the card."
        },
        "district": {
          "type": "string",
          "description": "The district where the card is registered."
        },
        "registeredMobile": {
          "type": "string",
          "description": "The mobile number registered with the smart card."
        },
        "profileCompleted": {
          "type": "boolean",
          "description": "Flag indicating if the user has completed their initial profile setup."
        },
        "familyMembers": {
          "type": "array",
          "description": "A list of family members on the ration card.",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "name": { "type": "string" },
              "age": { "type": "number" },
              "gender": { "type": "string" },
              "relation": { "type": "string" }
            },
            "required": ["id", "name", "relation"]
          }
        },
        "rationAllocation": {
          "type": "object",
          "description": "The monthly ration allocation for the card.",
          "properties": {
            "rawRice": { "type": "string" },
            "boiledRice": { "type": "string" },
            "wheat": { "type": "string" },
            "sugar": { "type": "string" },
            "palmOil": { "type": "string" },
            "toorDal": { "type": "string" }
          }
        },
        "name": {
            "type": "string",
            "description": "Name of the head of family."
        }
      },
      "required": [
        "registeredMobile",
        "familyMembers",
        "name"
      ]
    },
    "Booking": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Booking",
      "type": "object",
      "description": "Represents a time slot booking for ration collection.",
      "properties": {
        "date": {
          "type": "string",
          "format": "date",
          "description": "The selected date for ration collection."
        },
        "timeSlot": {
          "type": "string",
          "description": "The selected time slot for ration collection."
        },
        "status": {
          "type": "string",
          "description": "The status of the booking (e.g., Booked, Collected)."
        },
        "items": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": { "type": "string" },
              "quantity": { "type": "number" },
              "unit": { "type": "string" }
            }
          }
        },
        "paymentMethod": { "type": "string" },
        "totalAmount": { "type": "number" },
        "qrData": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["date", "timeSlot", "status", "paymentMethod"]
    },
    "SlotTracking": {
      "title": "SlotTracking",
      "type": "object",
      "description": "Tracks the number of bookings for a specific shop, date, and time slot.",
      "properties": {
        "count": { "type": "number", "description": "Number of citizens who have booked this slot." }
      },
      "required": ["count"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous",
      "phone"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/citizens/{citizenId}",
        "definition": {
          "entityName": "Citizen",
          "schema": {
            "$ref": "#/backend/entities/Citizen"
          },
          "description": "Stores citizen profile data, indexed by their Smart Card number (citizenId).",
          "params": [
            {
              "name": "citizenId",
              "description": "The unique Smart Card number of the citizen."
            }
          ]
        }
      },
      {
        "path": "/citizens/{citizenId}/bookings/{bookingId}",
        "definition": {
          "entityName": "Booking",
          "schema": {
            "$ref": "#/backend/entities/Booking"
          },
          "description": "Stores history of ration collection bookings for each citizen.",
          "params": [
            {
              "name": "citizenId",
              "description": "The unique Smart Card number of the citizen."
            },
             {
              "name": "bookingId",
              "description": "Unique identifier for the booking."
            }
          ]
        }
      },
      {
        "path": "/fps_slots/{slotId}",
        "definition": {
          "entityName": "SlotTracking",
          "schema": {
            "$ref": "#/backend/entities/SlotTracking"
          },
          "description": "Tracks slot availability. slotId format: {fpsCode}_{date}_{slotIndex}",
          "params": [
            {
              "name": "slotId",
              "description": "Unique identifier for the shop's slot on a specific day."
            }
          ]
        }
      }
    ]
  }
}
